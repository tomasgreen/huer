(function(){"use strict";function t(t){return t&&t.parentNode?void t.parentNode.removeChild(t):void 0}function n(t){var n=!1,e="Webkit Moz ms O".split(" "),o=document.createElement("div"),i=null;if(t=t.toLowerCase(),void 0!==o.style[t]&&(n=!0),n===!1){i=t.charAt(0).toUpperCase()+t.substr(1);for(var r=0;r<e.length;r++)if(void 0!==o.style[e[r]+i]){n=!0;break}}return n}function e(t){return Array.prototype.slice.call(t,0)}function o(t){return parseInt(t,10)}function i(t,n,e,o){var i,r;n||(n={}),-1!==t.indexOf(".")&&(r=t.split("."),t=r[0],r.shift(),n.class=r.join(" ")),-1!==t.indexOf("#")&&(r=t.split("#"),t=r[0],n.id=r[1]),i=document.createElement(t);for(var a in n)i.setAttribute(a,n[a]);return e&&e.appendChild(i),o&&(i.innerHTML=o),i}function r(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):window.event&&window.event.hasOwnProperty("cancelBubble")&&(window.event.cancelBubble=!0)}function a(t,n){if(!w)return void s(t,"click",n);var e=!1;s(t,"touchstart",function(){e=!0}),s(t,"touchend",function(t){e&&(n(),r(t))}),s(t,"touchcancel touchleave touchmove",function(){e=!1})}function u(t,n){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t){n(t)}):n(t))}function l(t,n,e,o){s(t,n,function(o){e(o),c(t,n,e)},o)}function s(t,n,e,o){u(t,function(t){var i=n.split(" ");for(var r in i)t.addEventListener(i[r],e,o)})}function c(t,n,e){u(t,function(t){var o=n.split(" ");for(var i in o)t.removeEventListener(o[i],e)})}function f(t,n){u(t,function(t){if(t.classList){var e=n.split(" ");for(var o in e)t.classList.add(e[o])}else t.className+=" "+n})}function d(t,n){u(t,function(t){if(t.classList){var e=n.split(" ");for(var o in e)t.classList.remove(e[o])}else t.className=t.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")})}function p(t,n,e,o){e&&l(t,g,e),l(t,g,function(e){d(t,n),o&&o(e)}),f(t,n)}function v(t,n,e){u(t,function(t){t.setAttribute(n,e)})}function y(t){return t===Object(t)}function h(t){return"string"==typeof t}function b(t){t.style.marginTop=t.offsetHeight/2*-1+"px",t.style.marginLeft=t.offsetWidth/2*-1+"px"}var m="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationend",g="webkitAnimationStart mozAnimationStart msAnimationStart oAnimationStart animationstart",w="ontouchstart"in document.documentElement,C={html:"Your view is empty.",showOnInit:!0,useEffects:!0,clickOutsideToDismiss:!1,overlayBackgroundColor:null,featureFailCallback:null,blurContent:!0,blurAllSiblings:!1,blurSelector:'[data-huer-effect="blur"]',wrapContent:!0,centerize:!0},k=function(){var t,e=this;y(arguments[0])?t=arguments[0]:arguments[0]&&(t={html:arguments[0]}),e.element=document.body,e.opt={},e.vars={},void 0===t&&(t={});for(var o in C)e.opt[o]=void 0!==t[o]?t[o]:C[o];var r={animation:n("animation"),transition:n("transition"),transform:n("transform"),filter:n("filter"),query:void 0!==document.querySelectorAll};if(r.filter||(e.opt.blurContent=!1),r.animation&&r.transition&&r.transform||(e.opt.useEffects=!1),!r.query)return void(e.opt.featureFailCallback?e.opt.featureFailCallback(r):alert("Your browser is lacking certain features. Please update to a modern browser."));var a=i("div.huer-container"),u=i("div.huer-overlay",null,a),l=i("div.huer-body",null,a);e.opt.overlayBackgroundColor&&(u.style.backgroundColor=e.opt.overlayBackgroundColor),e.opt.wrapContent?i("div.huer-content-wrapper",null,l,e.opt.html):l.innerHTML=e.opt.html,e.container=a,e.overlay=u,e.body=l,e.element.appendChild(e.container),e.click('[data-destroy="click"]',function(){e.destroy()}),e.vars.onOverlayClickEvent=e.onOverlayClick.bind(e),e.click(e.overlay,e.vars.onOverlayClickEvent),e.opt.showOnInit&&e.show()};k.prototype.blurContent=function(){var t=this;if(t.opt.blurContent)for(var n=t.opt.blurAllSiblings?t.container.parentNode.childNodes:document.querySelectorAll(t.opt.blurSelector),e=0;e<n.length;e++)n[e]!=t.container&&f(n[e],"huer-blur")},k.prototype.focusContent=function(){var t=this;if(t.opt.blurContent){var n=document.querySelectorAll(".huer-blur");d(n,"huer-blur"),p(n,"huer-focus")}},k.prototype.toggleEffects=function(t){var n=this;if(!n.opt.useEffects)return void(t&&t());if(n.isVisible){var e=function(){d(n.overlay,"huer-fade-out"),d(n.body,"huer-zoom-out"),n.container.style.display="none",t&&t()};l(n.body,m,e),f(n.overlay,"huer-fade-out"),f(n.body,"huer-zoom-out"),n.focusContent()}else{var o=function(){d(n.overlay,"huer-fade-in"),d(n.body,"huer-bounce-in"),t&&t()};l(n.body,m,o),f(n.overlay,"huer-fade-in"),f(n.body,"huer-bounce-in"),n.blurContent()}},k.prototype.show=function(t){var n=this;n.isVisible||(n.container.style.visibility="hidden",n.container.style.display="block",n.opt.centerize&&b(n.body),n.container.style.visibility="visible",n.toggleEffects(t),n.vars.onWindowKeydownEvent=n.onWindowKeydown.bind(n),s(window,"keydown",n.vars.onWindowKeydownEvent),n.focusElement(!0),n.isVisible=!0)},k.prototype.onOverlayClick=function(){this.opt.clickOutsideToDismiss&&!this.isBusy()&&this.destroy()},k.prototype.onWindowKeydown=function(t){var n=t.keyCode||t.which;-1!==[9,13,32,27].indexOf(n)&&9===n&&(r(t),this.focusElement())},k.prototype.focusElement=function(t){t&&(this.lastTabindex=null);var n=this.query("[tabindex]");if(!n.length)return void this.overlay.focus();if(n=e(n),n.sort(function(t,n){return t.getAttribute&&n.getAttribute?o(t.getAttribute("tabindex"))-o(n.getAttribute("tabindex")):-1}),this.lastTabindex)for(var i=0;i<n.length;i++)if(n[i].getAttribute("tabindex")==this.lastTabindex&&i<n.length-1)return n[i+1].focus(),void(this.lastTabindex=n[i+1].getAttribute("tabindex"));n[0].focus(),this.lastTabindex=n[0].getAttribute("tabindex")},k.prototype.hide=function(t){this.isVisible&&(c(window,"keydown",this.vars.onWindowKeydownEvent),this.toggleEffects(t),this.isVisible=!1)},k.prototype.getHtml=function(){return this.container},k.prototype.query=function(t){return e(this.container.querySelectorAll(t))},k.prototype.click=function(t,n){h(t)&&(t=this.query(t)),a(t,n)},k.prototype.attr=function(t,n,o){h(t)&&(t=this.query(t)),v(e(t),n,o)},k.prototype.isBusy=function(t){return void 0===t||t!==!0&&t!==!1||(this.busy=t),this.busy||!1},k.prototype.destroy=function(){var n=this;n.hide(function(){t(n.container),n=null})};var A=null;this.huer=function(t){return A&&(A.opt.blurContent=!1,A.destroy()),A=new k(t)},this.huer.globals=C}).call(this);